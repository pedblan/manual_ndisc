import json
import pandas as pd

# JSON de saída do modelo (cole aqui como string)
data = '''{ "spans": [ { "label": "analogia", "start_char": 0, "end_char": 0, "text": "Aquilo para mim foi o símbolo do Brasil, até o mapa brasileiro lembra um pouco o Volkswagen.", "rationale": "Compara o Brasil ao fusca para evidenciar o simulacro de modernidade; é uma relação de semelhança explícita.", "cues": [ "símbolo do Brasil", "lembra um pouco o Volkswagen" ], "confidence": 0.83 }, { "label": "metafora", "start_char": 0, "end_char": 0, "text": "Nós somos um país que fechamos os vidros, vivemos no calor da violência, da deseducação e da pobreza para dar a impressão de que somos desenvolvidos.", "rationale": "“Fechar os vidros” e “viver no calor da violência” funcionam como imagens metafóricas do autoengano e do ambiente social opressivo.", "cues": [ "fechamos os vidros", "calor da violência", "dar a impressão" ], "confidence": 0.87 }, { "label": "prosopopeia", "start_char": 0, "end_char": 0, "text": "As ruas estão vazias, não está havendo manifestação, mas as ruas não estão caladas...", "rationale": "Atribui às ruas a capacidade de calar/falar, humanizando um espaço físico.", "cues": [ "ruas estão vazias", "ruas não estão caladas" ], "confidence": 0.82 }, { "label": "anafora", "start_char": 0, "end_char": 0, "text": "O povo está descontente... o povo está descontente... o povo está descontente... O povo está falando e nós não estamos ouvindo.", "rationale": "Repetição inicial de “O povo está...” para intensificar a ideia de descontentamento generalizado.", "cues": [ "O povo está...", "repetição" ], "confidence": 0.9 }, { "label": "antitese", "start_char": 0, "end_char": 0, "text": "além de mais polícia, haja mais professores, que além de mais cadeia haja mais escolas.", "rationale": "Oposição entre repressão (polícia, cadeia) e prevenção/integração (professores, escolas).", "cues": [ "mais polícia / mais professores", "mais cadeia / mais escolas" ], "confidence": 0.89 }, { "label": "gradacao", "start_char": 0, "end_char": 0, "text": "Às vezes leva décadas, às vezes leva anos, às vezes a gente acorda e descobre que o povo já está na rua...", "rationale": "Sequência que passa de períodos longos (décadas) a curtos (anos) e ao súbito (acorda), criando progressão.", "cues": [ "Às vezes... décadas", "Às vezes... anos", "a gente acorda" ], "confidence": 0.78 }, { "label": "anafora", "start_char": 0, "end_char": 0, "text": "Nós nos acostumamos. ... Nós nos acostumamos. ... Nós nos acostumamos.", "rationale": "Repetição insistente para marcar a naturalização da violência e da miséria.", "cues": [ "Nós nos acostumamos" ], "confidence": 0.9 }, { "label": "antitese", "start_char": 0, "end_char": 0, "text": "Neste País, a gente acha que resolve os problemas com pequenos gestos, mas eles são gigantescos.", "rationale": "Contraposição entre a pequenez das medidas e a magnitude dos problemas.", "cues": [ "pequenos gestos", "problemas gigantescos" ], "confidence": 0.79 }, { "label": "metafora", "start_char": 0, "end_char": 0, "text": "passar o Brasil a limpo", "rationale": "Expressão figurada para indicar saneamento moral/institucional do país.", "cues": [ "a limpo" ], "confidence": 0.7 }, { "label": "antitese", "start_char": 0, "end_char": 0, "text": "construindo pontes com os pobres... preferiu criar muros contra os pobres.", "rationale": "Oposição simbólica entre integrar (pontes) e segregar (muros).", "cues": [ "pontes", "muros", "com os pobres / contra os pobres" ], "confidence": 0.9 }, { "label": "paradoxo", "start_char": 0, "end_char": 0, "text": "Libertamos os escravos em 1888. Agora a gente está precisando libertar os ricos da prisão em que vivem. ... o único jeito de libertar os ricos ... é libertando os pobres da pobreza.", "rationale": "Afirma a “prisão” dos ricos e a necessidade de libertá-los via libertação dos pobres, ideia aparentemente contraditória que revela interdependência social.", "cues": [ "libertar os ricos", "prisão em que vivem", "libertando os pobres" ], "confidence": 0.86 }, { "label": "paradoxo", "start_char": 0, "end_char": 0, "text": "Este País é o maior exportador de alimentos do mundo, e tem gente que tem fome!", "rationale": "Convivência contraditória entre abundância produtiva e fome.", "cues": [ "maior exportador", "tem fome" ], "confidence": 0.9 }, { "label": "pergunta_retórica", "start_char": 0, "end_char": 0, "text": "Dando sequência... vale a pena perguntar: por que?", "rationale": "Pergunta feita não para obter resposta imediata, mas para provocar reflexão sobre a inação do Senado.", "cues": [ "por que?" ], "confidence": 0.78 }, { "label": "pergunta_retórica", "start_char": 0, "end_char": 0, "text": "Quem neste País, que instituição, Senador Pedro Simon, poderá trazer essa quebra da lógica, à procura de um novo caminho?", "rationale": "Interrogação destinada a enfatizar a responsabilidade do Senado, não a obter uma resposta factual.", "cues": [ "Quem neste País...?" ], "confidence": 0.82 }, { "label": "prosopopeia", "start_char": 0, "end_char": 0, "text": "É a lógica que está nos aprisionando...", "rationale": "Personifica a “lógica” como agente que aprisiona.", "cues": [ "lógica... aprisionando" ], "confidence": 0.76 }, { "label": "metafora", "start_char": 0, "end_char": 0, "text": "O silêncio é o túmulo do intelectual.", "rationale": "Compara silêncio a túmulo para expressar a morte simbólica da função crítica do intelectual.", "cues": [ "túmulo do intelectual" ], "confidence": 0.88 }, { "label": "citacao_de_autoridade", "start_char": 0, "end_char": 0, "text": "... ouvindo o Bom Dia Brasil. ... o editorial dito pelo jornalista Alexandre Garcia. O que ele falou hoje, olhando nos nossos olhos...", "rationale": "Apoia-se na autoridade de um jornalista reconhecido para reforçar o diagnóstico da crise.", "cues": [ "editorial", "jornalista Alexandre Garcia" ], "confidence": 0.7 }, { "label": "citacao_de_autoridade", "start_char": 0, "end_char": 0, "text": "... no Brasil vai haver um tempo em que alguns não vão dormir de medo dos que não dormem porque têm fome - uns não dormem porque têm fome e outros não dormem de medo daqueles que não dormem porque têm fome.", "rationale": "Cita um dito atribuído a Almeida José de Castro para fundamentar o argumento sobre tensão social.", "cues": [ "disse... há um tempo", "citação proverbial" ], "confidence": 0.85 }, { "label": "apelo_popular", "start_char": 0, "end_char": 0, "text": "O povo está falando e nós não estamos ouvindo. ... O povo tem limite na sua paciência.", "rationale": "Evoca diretamente o “povo” para criar identificação e urgência moral.", "cues": [ "O povo...", "paciência do povo" ], "confidence": 0.86 }, { "label": "hiperbole", "start_char": 0, "end_char": 0, "text": "O povo brasileiro é tão pacífico que não se revolta quando não tem comida.", "rationale": "Exagera o grau de pacifismo para realçar a resignação social.", "cues": [ "tão pacífico", "não se revolta" ], "confidence": 0.65 }, { "label": "ironia", "start_char": 0, "end_char": 0, "text": "Quero concluir... já que o Presidente cortou minha palavra, logo ele, que usa muito o tempo aqui, e sempre, e que é o mais tolerante de todos!", "rationale": "Louvor aparente ao Presidente que, no contexto, funciona como crítica à interrupção pelo tempo.", "cues": [ "logo ele", "o mais tolerante de todos" ], "confidence": 0.74 }, { "label": "sarcasmo", "start_char": 0, "end_char": 0, "text": "O Sr. Pedro Simon: “Principalmente quando tem mandato perpétuo.”", "rationale": "Comentário mordaz sobre a intervenção de ministro do TSE, aludindo ao caráter vitalício da magistratura.", "cues": [ "mandato perpétuo" ], "confidence": 0.72 }, { "label": "aliteracao", "start_char": 0, "end_char": 0, "text": "Acostumados e acomodados!", "rationale": "Repetição de sons iniciais “aco-/aco-” reforça musicalidade e fixação da ideia.", "cues": [ "repetição sonora" ], "confidence": 0.68 }, { "label": "metonimia", "start_char": 0, "end_char": 0, "text": "As ruas estão vazias...", "rationale": "“Ruas” representa metonimicamente a esfera pública e a população em manifestação.", "cues": [ "ruas (por manifestantes/povo)" ], "confidence": 0.62 } ] }'''  # substitua pelos dados completos

parsed = json.loads(data)
df = pd.DataFrame(parsed["spans"])

# Ajustar para porcentagem
df["confidence"] = (df["confidence"] * 100).round(0).astype(int).astype(str) + "%"

# Renomear colunas para exibição
df = df.rename(columns={
    "label": "Figura",
    "text": "Trecho",
    "rationale": "Justificativa",
    "cues": "Pistas",
    "confidence": "Confiança"
})

# Exportar para Word
from docx import Document
doc = Document()
doc.add_heading("Figuras de Linguagem Detectadas", level=1)

# Criar tabela
table = doc.add_table(rows=1, cols=len(df.columns))
hdr_cells = table.rows[0].cells
for i, col in enumerate(df.columns):
    hdr_cells[i].text = col

for _, row in df.iterrows():
    row_cells = table.add_row().cells
    for i, val in enumerate(row):
        row_cells[i].text = str(val)

doc.save("figuras_linguagem.docx")
